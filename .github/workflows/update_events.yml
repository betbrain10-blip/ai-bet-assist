name: Aggiorna eventi automatici

on:
  schedule:
    - cron: "0 9 * * *"   # ogni giorno alle 09:00
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Genera events.json (inline)
        run: |
          cat << 'EOF' > events.json
          {
            "updated_at": "$(date '+%Y-%m-%d %H:%M')",
            "timezone": "Europe/Rome",
            "events": [
              {
                "league": "Serie A",
                "home": "Inter",
                "away": "Juventus",
                "start": "Oggi 20:45",
                "markets": [
                  { "label": "Over 1.5", "odd": 1.55 },
                  { "label": "1X", "odd": 1.65 },
                  { "label": "DNB 1", "odd": 1.70 }
                ]
              },
              {
                "league": "Serie A",
                "home": "Milan",
                "away": "Roma",
                "start": "Oggi 18:00",
                "markets": [
                  { "label": "Goal/NoGoal SÃ¬", "odd": 1.75 },
                  { "label": "Over 2.5", "odd": 1.85 }
                ]
              }
            ]
          }
          EOF

      - name: Commit & push events.json
        run: |
          git config user.name "github-actions"
          git config user.email "github-actions@github.com"
          git add events.json
          git commit -m "Auto update events" || echo "Niente da committare"
          git push
